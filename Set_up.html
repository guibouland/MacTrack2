

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Set_up &mdash; MacTrack2 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MacTrack2" href="mactrack.html" />
    <link rel="prev" title="Getting started" href="gettingstarted.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MacTrack2
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart for MacTrack2</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Set_up</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-Set_up.Structure">structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.Structure.copy_zip_files"><code class="docutils literal notranslate"><span class="pre">copy_zip_files()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-Set_up.convert">convert</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.convert.convert_all_avi_in_folder"><code class="docutils literal notranslate"><span class="pre">convert_all_avi_in_folder()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.convert.convert_avi_to_mp4"><code class="docutils literal notranslate"><span class="pre">convert_avi_to_mp4()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.convert.delete_avi_files"><code class="docutils literal notranslate"><span class="pre">delete_avi_files()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-Set_up.count">count</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.count.get_frame_count"><code class="docutils literal notranslate"><span class="pre">get_frame_count()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-Set_up.dataset_csv">dataset_csv</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.dataset_csv.create_dataset_csv"><code class="docutils literal notranslate"><span class="pre">create_dataset_csv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.dataset_csv.create_meta_file"><code class="docutils literal notranslate"><span class="pre">create_meta_file()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-Set_up.empty_zip">empty_zip</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.empty_zip.empty_dataset_testy_zip"><code class="docutils literal notranslate"><span class="pre">empty_dataset_testy_zip()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.empty_zip.empty_dataset_testy_zip_single_frame"><code class="docutils literal notranslate"><span class="pre">empty_dataset_testy_zip_single_frame()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#eval-models">eval_models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-Set_up.explain_model">explain_model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.explain_model.SummaryModel"><code class="docutils literal notranslate"><span class="pre">SummaryModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Set_up.explain_model.SummaryModel.format_dataframe"><code class="docutils literal notranslate"><span class="pre">SummaryModel.format_dataframe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Set_up.explain_model.SummaryModel.format_dict"><code class="docutils literal notranslate"><span class="pre">SummaryModel.format_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Set_up.explain_model.SummaryModel.format_list"><code class="docutils literal notranslate"><span class="pre">SummaryModel.format_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Set_up.explain_model.SummaryModel.keys"><code class="docutils literal notranslate"><span class="pre">SummaryModel.keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Set_up.explain_model.SummaryModel.template"><code class="docutils literal notranslate"><span class="pre">SummaryModel.template()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Set_up.explain_model.SummaryModel.to_csv"><code class="docutils literal notranslate"><span class="pre">SummaryModel.to_csv()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.explain_model.get_function"><code class="docutils literal notranslate"><span class="pre">get_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.explain_model.summary_model"><code class="docutils literal notranslate"><span class="pre">summary_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-Set_up.extract_frames">extract_frames</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Set_up.extract_frames.extract_frames"><code class="docutils literal notranslate"><span class="pre">extract_frames()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#train-model">train_model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mactrack.html">MacTrack2</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MacTrack2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Set_up</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Set_up.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="set-up">
<h1>Set_up<a class="headerlink" href="#set-up" title="Link to this heading"></a></h1>
<section id="module-Set_up.Structure">
<span id="structure"></span><h2>structure<a class="headerlink" href="#module-Set_up.Structure" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="Set_up.Structure.copy_zip_files">
<span class="sig-prename descclassname"><span class="pre">Set_up.Structure.</span></span><span class="sig-name descname"><span class="pre">copy_zip_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/Structure.html#copy_zip_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.Structure.copy_zip_files" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-Set_up.convert">
<span id="convert"></span><h2>convert<a class="headerlink" href="#module-Set_up.convert" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="Set_up.convert.convert_all_avi_in_folder">
<span class="sig-prename descclassname"><span class="pre">Set_up.convert.</span></span><span class="sig-name descname"><span class="pre">convert_all_avi_in_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/convert.html#convert_all_avi_in_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.convert.convert_all_avi_in_folder" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Set_up.convert.convert_avi_to_mp4">
<span class="sig-prename descclassname"><span class="pre">Set_up.convert.</span></span><span class="sig-name descname"><span class="pre">convert_avi_to_mp4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avi_file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/convert.html#convert_avi_to_mp4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.convert.convert_avi_to_mp4" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Set_up.convert.delete_avi_files">
<span class="sig-prename descclassname"><span class="pre">Set_up.convert.</span></span><span class="sig-name descname"><span class="pre">delete_avi_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/convert.html#delete_avi_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.convert.delete_avi_files" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-Set_up.count">
<span id="count"></span><h2>count<a class="headerlink" href="#module-Set_up.count" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="Set_up.count.get_frame_count">
<span class="sig-prename descclassname"><span class="pre">Set_up.count.</span></span><span class="sig-name descname"><span class="pre">get_frame_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/count.html#get_frame_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.count.get_frame_count" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-Set_up.dataset_csv">
<span id="dataset-csv"></span><h2>dataset_csv<a class="headerlink" href="#module-Set_up.dataset_csv" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="Set_up.dataset_csv.create_dataset_csv">
<span class="sig-prename descclassname"><span class="pre">Set_up.dataset_csv.</span></span><span class="sig-name descname"><span class="pre">create_dataset_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_csv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/dataset_csv.html#create_dataset_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.dataset_csv.create_dataset_csv" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Set_up.dataset_csv.create_meta_file">
<span class="sig-prename descclassname"><span class="pre">Set_up.dataset_csv.</span></span><span class="sig-name descname"><span class="pre">create_meta_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/dataset_csv.html#create_meta_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.dataset_csv.create_meta_file" title="Link to this definition"></a></dt>
<dd><p>Create a META.json file for ‘dataset’ structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>meta_path</strong> (<em>str</em>) – Path to the META.json file to be created.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-Set_up.empty_zip">
<span id="empty-zip"></span><h2>empty_zip<a class="headerlink" href="#module-Set_up.empty_zip" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="Set_up.empty_zip.empty_dataset_testy_zip">
<span class="sig-prename descclassname"><span class="pre">Set_up.empty_zip.</span></span><span class="sig-name descname"><span class="pre">empty_dataset_testy_zip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">testy_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/empty_zip.html#empty_dataset_testy_zip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.empty_zip.empty_dataset_testy_zip" title="Link to this definition"></a></dt>
<dd><p>Function that creates empty zip files.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Set_up.empty_zip.empty_dataset_testy_zip_single_frame">
<span class="sig-prename descclassname"><span class="pre">Set_up.empty_zip.</span></span><span class="sig-name descname"><span class="pre">empty_dataset_testy_zip_single_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">testy_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/empty_zip.html#empty_dataset_testy_zip_single_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.empty_zip.empty_dataset_testy_zip_single_frame" title="Link to this definition"></a></dt>
<dd><p>Function that creates empty zip file.</p>
</dd></dl>

</section>
<section id="eval-models">
<h2>eval_models<a class="headerlink" href="#eval-models" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Source code for model testing</span>
<span class="linenos"> 2</span><span class="c1"># ########################################################</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="linenos"> 5</span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kn">from</span><span class="w"> </span><span class="nn">kartezio.easy</span><span class="w"> </span><span class="kn">import</span> <span class="n">print_stats</span>
<span class="linenos"> 8</span><span class="kn">from</span><span class="w"> </span><span class="nn">kartezio.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_dataset</span>
<span class="linenos"> 9</span><span class="kn">from</span><span class="w"> </span><span class="nn">kartezio.fitness</span><span class="w"> </span><span class="kn">import</span> <span class="n">FitnessIOU</span>
<span class="linenos">10</span><span class="kn">from</span><span class="w"> </span><span class="nn">kartezio.inference</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelPool</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">scores_all</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">13</span><span class="n">pool</span> <span class="o">=</span> <span class="n">ModelPool</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./models&quot;</span><span class="p">,</span> <span class="n">FitnessIOU</span><span class="p">(),</span> <span class="n">regex</span><span class="o">=</span><span class="s2">&quot;*/elite.json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_ensemble</span><span class="p">()</span>
<span class="linenos">14</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">read_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./dataset&quot;</span><span class="p">,</span> <span class="n">counting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">annotations_test</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">16</span><span class="n">annotations_training</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">17</span><span class="n">roi_pixel_areas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">18</span><span class="k">for</span> <span class="n">y_true</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">train_y</span><span class="p">:</span>
<span class="linenos">19</span>    <span class="n">n_annotations</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">20</span>    <span class="n">annotations_training</span> <span class="o">+=</span> <span class="n">n_annotations</span>
<span class="linenos">21</span><span class="k">for</span> <span class="n">y_true</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">test_y</span><span class="p">:</span>
<span class="linenos">22</span>    <span class="n">annotations</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">23</span>    <span class="n">n_annotations</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">24</span>    <span class="n">annotations_test</span> <span class="o">+=</span> <span class="n">n_annotations</span>
<span class="linenos">25</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_annotations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<span class="linenos">26</span>        <span class="n">roi_pixel_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">annotations</span><span class="p">[</span><span class="n">annotations</span> <span class="o">==</span> <span class="n">i</span><span class="p">]))</span>
<span class="linenos">27</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total annotations for training set: </span><span class="si">{</span><span class="n">annotations_training</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">28</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total annotations for test set: </span><span class="si">{</span><span class="n">annotations_test</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">29</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean pixel area for test set: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">roi_pixel_areas</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">30</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="n">scores_test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">33</span><span class="n">scores_training</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">34</span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">models</span><span class="p">):</span>
<span class="linenos">35</span>    <span class="c1"># Test set</span>
<span class="linenos">36</span>    <span class="n">_</span><span class="p">,</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="linenos">37</span>    <span class="n">scores_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fitness</span><span class="p">)</span>
<span class="linenos">38</span>
<span class="linenos">39</span>    <span class="c1"># Training set</span>
<span class="linenos">40</span>    <span class="n">_</span><span class="p">,</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="linenos">41</span>    <span class="n">scores_training</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fitness</span><span class="p">)</span>
<span class="linenos">42</span>
<span class="linenos">43</span>
<span class="linenos">44</span><span class="n">scores_all</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;training&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores_training</span>
<span class="linenos">45</span><span class="n">scores_all</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores_test</span>
<span class="linenos">46</span><span class="n">print_stats</span><span class="p">(</span><span class="n">scores_training</span><span class="p">,</span> <span class="s2">&quot;AP50&quot;</span><span class="p">,</span> <span class="s2">&quot;training set&quot;</span><span class="p">)</span>
<span class="linenos">47</span><span class="n">print_stats</span><span class="p">(</span><span class="n">scores_test</span><span class="p">,</span> <span class="s2">&quot;AP50&quot;</span><span class="p">,</span> <span class="s2">&quot;test set&quot;</span><span class="p">)</span>
<span class="linenos">48</span>
<span class="linenos">49</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores_all</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;./results/results.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="module-Set_up.explain_model">
<span id="explain-model"></span><h2>explain_model<a class="headerlink" href="#module-Set_up.explain_model" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="Set_up.explain_model.SummaryModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Set_up.explain_model.</span></span><span class="sig-name descname"><span class="pre">SummaryModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/explain_model.html#SummaryModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.explain_model.SummaryModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="Set_up.explain_model.SummaryModel.format_dataframe">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">format_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/explain_model.html#SummaryModel.format_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.explain_model.SummaryModel.format_dataframe" title="Link to this definition"></a></dt>
<dd><p>Dataframe formatting for display.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Set_up.explain_model.SummaryModel.format_dict">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">format_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dct</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/explain_model.html#SummaryModel.format_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.explain_model.SummaryModel.format_dict" title="Link to this definition"></a></dt>
<dd><p>Dictionary formatting for display.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Set_up.explain_model.SummaryModel.format_list">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">format_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/explain_model.html#SummaryModel.format_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.explain_model.SummaryModel.format_list" title="Link to this definition"></a></dt>
<dd><p>List formatting for display.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Set_up.explain_model.SummaryModel.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/explain_model.html#SummaryModel.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.explain_model.SummaryModel.keys" title="Link to this definition"></a></dt>
<dd><p>This function returns the keys of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Set_up.explain_model.SummaryModel.template">
<span class="sig-name descname"><span class="pre">template</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/explain_model.html#SummaryModel.template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.explain_model.SummaryModel.template" title="Link to this definition"></a></dt>
<dd><p>This function returns a formatted string that summarizes the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Set_up.explain_model.SummaryModel.to_csv">
<span class="sig-name descname"><span class="pre">to_csv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/explain_model.html#SummaryModel.to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.explain_model.SummaryModel.to_csv" title="Link to this definition"></a></dt>
<dd><p>This function saves the nodes dataframe to a CSV file. If an index is provided, it appends the index to the filename for uniqueness.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Set_up.explain_model.get_function">
<span class="sig-prename descclassname"><span class="pre">Set_up.explain_model.</span></span><span class="sig-name descname"><span class="pre">get_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/explain_model.html#get_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.explain_model.get_function" title="Link to this definition"></a></dt>
<dd><p>Extracts the function names from the sequence based on their IDs.</p>
<p>The functions are from OpenCV and are used to create the model using Kartezio
(not all OpenCV functions are used). The function ID is the index of the
function in the list of functions chosen in the Kartezio package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> (<em>list</em>) – The sequence of the model, following the Kartezio architecture:
[function_id, c_1, c_2, …, c_n, p_1, p_2, …, p_l]
- function_id: Index of the function in the list of functions.
- c_i: Connections (n is the number of connections).
- p_k: Parameters (l is the number of parameters).</p></li>
<li><p><strong>functions</strong> (<em>list</em>) – The list of functions available in the Kartezio package.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of function names corresponding to the function_id in the sequence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Set_up.explain_model.summary_model">
<span class="sig-prename descclassname"><span class="pre">Set_up.explain_model.</span></span><span class="sig-name descname"><span class="pre">summary_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_folder</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/explain_model.html#summary_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.explain_model.summary_model" title="Link to this definition"></a></dt>
<dd><p>This function loads models from all subdirectories in a specified folder and creates summaries.</p>
<p>Parameters:
model_folder (str): The name of the folder containing the ‘models’ folder.</p>
</dd></dl>

</section>
<section id="module-Set_up.extract_frames">
<span id="extract-frames"></span><h2>extract_frames<a class="headerlink" href="#module-Set_up.extract_frames" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="Set_up.extract_frames.extract_frames">
<span class="sig-prename descclassname"><span class="pre">Set_up.extract_frames.</span></span><span class="sig-name descname"><span class="pre">extract_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Set_up/extract_frames.html#extract_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Set_up.extract_frames.extract_frames" title="Link to this definition"></a></dt>
<dd><p>Extract frames from an MP4 video and save them as PNG images with a fixed resolution.
Ensures uniform frame size by resizing and padding if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> – Path to the input MP4 video file.</p></li>
<li><p><strong>output_folder</strong> – Path to the folder where frames will be saved.</p></li>
<li><p><strong>fps</strong> – Frames per second to extract.</p></li>
<li><p><strong>width</strong> – Output frame width.</p></li>
<li><p><strong>height</strong> – Output frame height.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="train-model">
<h2>train_model<a class="headerlink" href="#train-model" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Source code for model training</span>
<span class="linenos"> 2</span><span class="c1"># ########################################################</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">from</span><span class="w"> </span><span class="nn">kartezio.apps.segmentation</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_segmentation_model</span>
<span class="linenos"> 5</span><span class="kn">from</span><span class="w"> </span><span class="nn">kartezio.endpoint</span><span class="w"> </span><span class="kn">import</span> <span class="n">EndpointThreshold</span>
<span class="linenos"> 6</span><span class="kn">from</span><span class="w"> </span><span class="nn">kartezio.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_dataset</span>
<span class="linenos"> 7</span><span class="kn">from</span><span class="w"> </span><span class="nn">kartezio.training</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_model</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">DATASET</span> <span class="o">=</span> <span class="s2">&quot;./dataset&quot;</span>
<span class="linenos">11</span><span class="n">OUTPUT</span> <span class="o">=</span> <span class="s2">&quot;./models&quot;</span>
<span class="linenos">12</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">generations</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="linenos">15</span><span class="n">_lambda</span> <span class="o">=</span> <span class="mi">5</span>
<span class="linenos">16</span><span class="n">frequency</span> <span class="o">=</span> <span class="mi">5</span>
<span class="linenos">17</span><span class="n">rate</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="linenos">18</span><span class="nb">print</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span>
<span class="linenos">19</span><span class="n">model</span> <span class="o">=</span> <span class="n">create_segmentation_model</span><span class="p">(</span>
<span class="linenos">20</span>    <span class="n">generations</span><span class="p">,</span>
<span class="linenos">21</span>    <span class="n">_lambda</span><span class="p">,</span>
<span class="linenos">22</span>    <span class="n">inputs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="linenos">23</span>    <span class="n">nodes</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<span class="linenos">24</span>    <span class="n">node_mutation_rate</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span>
<span class="linenos">25</span>    <span class="n">output_mutation_rate</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span>
<span class="linenos">26</span>    <span class="n">outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos">27</span>    <span class="n">fitness</span><span class="o">=</span><span class="s2">&quot;IOU&quot;</span><span class="p">,</span>
<span class="linenos">28</span>    <span class="n">endpoint</span><span class="o">=</span><span class="n">EndpointThreshold</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
<span class="linenos">29</span><span class="p">)</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">read_dataset</span><span class="p">(</span><span class="n">DATASET</span><span class="p">)</span>
<span class="linenos">32</span><span class="n">elite</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">,</span> <span class="n">callback_frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gettingstarted.html" class="btn btn-neutral float-left" title="Getting started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mactrack.html" class="btn btn-neutral float-right" title="MacTrack2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Guillaume Bouland.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>